= subscribe_to "/messages/public"
= subscribe_to "/messages/private/#{session[:username]}"

:javascript
  $(function() {
    // Subscribe to the public channel
    PrivatePub.subscribe('/messages/public', function(data) {
      $('<p></p>').html(data.username + ': ' + data.msg).appendTo('#chat_room');
    });

    // Our own private channel
    PrivatePub.subscribe("/messages/private/#{session[:username]}", function(data) {
      $('<p></p>').addClass('private').html(data.username + ": " + data.msg).appendTo('#chat_room');
    });
  });

.chat_container
  #chat_room

  = form_tag new_message_path, remote: true do
    .input-prepend.input-append
      .btn-group
        %button.btn.dropdown-toggle{ 'data-toggle' => 'dropdown' }
          Choose&hellip;
          %span.caret
        %ul.dropdown-menu
          %li
            %a Say
          %li
            %a Narrative
          %li
            %a Slugline

      = text_field_tag :message, nil, placeholder: 'What do you say?', class: 'span7'
      = submit_tag 'Send', disable_with: 'Sendingâ€¦', class: 'btn'
